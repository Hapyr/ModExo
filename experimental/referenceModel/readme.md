### Parameter Estimation

The controller implements a simple integration algorithm which calculates the output position of the joint according to the given torque input. The relation between torque and position is defined by the second order equation:

	tau = J*X3 + b*X2 + k*X1

Where X1, X2 and X3 are, respectively, angular position, angular velocity and angular acceleration. Although J, b and k could have a physical correspondence to Inertia, Dumping and Stiffness, because the process is discrete, they have no physical meaning and can be simply assumed as coefficients multiplying those variables. For that reason, those variables will be referred as the vector Ad = [ad0, ad1, ad2] = [J, b, k]. Below are described the steps to find constants that will adjust J, b and k to the international standard. 

Our goal is to estimate a vector Ahat to find a vector W = [w0, w1, w2] such as Ad*W = Ahat.

#### Model Reference Tracking

As already mentioned in the control structure, the High Level Controller calculates the reference model position for a given input. The Low Level Controller task is to make the joint position as close as possible to that virtual position. In figures 1 and 2, it is possible to observe the tracking performance for the joint with no extra mass.

![Model Reference Tracking](https://biopmr.github.io/images/modelReferenceTracking.png)

![Model Reference Tracking 2](https://biopmr.github.io/images/modelReferenceTracking2.png)

The figures show two plots, \theta_m refers to the Model Reference Position calculated by the Arduino when submitted by a 50mNm torque input. \theta_e refers to the joint position given by the MILE Encoder in the motor. It is possible to observe that the curves are really close. Further experiments are required with higher impedance attached to the joint, however, for the analysis that will follow, we will consider that there is no significative difference in between the virtual dynamics requested by the Reference Model and the apparent dynamics performed by the Plant.

For these curves, the parameters set to the Arduino are Ad = [0.05, 1, 10]

#### Transfer Function Estimation

In order to obtain the estimation vector Ahat, we will be looking at the position generated by the Arduino from the previous section and, with the MATLAB function _tfest_, estimating a transfer function which reproduces that response. From the transfer function we obtain a state spaces representation, which contains the parameters Ahat in the form:

A = [-b/J -k/J ; 1 0 ];





